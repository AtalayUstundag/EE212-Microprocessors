ORG 0

	acall	CONFIGURE_LCD   
	clr A
	mov DPTR,#INPUT

DATA_LOOP:  			
	movc a,@a+dptr
	jz KEYBOARD_LOOP
	acall SEND_DATA
	clr a
	inc dptr
	sjmp DATA_LOOP

KEYBOARD_LOOP:

	acall KEYBOARD		
	CJNE A, #41H, HERE
	SJMP FIN
HERE:
	acall SEND_DATA 	
	CLR  C 
	SUBB A, #30H
	MOV R4, A

	acall KEYBOARD		
	CJNE A, #41H, BURA1
	MOV R3, 04H  
	SJMP FIN
BURA1:
	acall SEND_DATA 	
	CLR  C 
	SUBB A, #030H
	MOV R5, A

	acall KEYBOARD		
	CJNE A, #041H, BURA2
	MOV A, R4
	MOV B, #0AH
	MUL AB
	ADD A, R5
	MOV R3, A 
	SJMP FIN
	
BURA2:
	acall SEND_DATA 	
	CLR  C 
	SUBB A, #030H
	MOV R6, A

	MOV B, #064H
	MOV A, R4
	MUL AB
	MOV R2, B
	MOV R3, A
	MOV B, #0AH
	MOV A, R5
	MUL AB
	ADD A, R3
	JNC BURA5
	INC R2
BURA5:  ADD A, R6
	JNC BURA4
	INC R2
BURA4:
	MOV R3, A
	
AAA:	
	acall KEYBOARD		
	CJNE A, #65D, AAA
FIN: 


	
	MOV A, R3
	MOV R0,A 
	MOV A, R2 
	MOV R1, A 
	MOV B ,#00D
	CLR A 
	MOV R2, #00D
	MOV R3, #00D
	MOV R4,#00D
	MOV R5, #00D
	MOV R6, #00D
	MOV R7, #00D
	MOV B, #07D
	CJNE R1, #00H, KONTROL1
	MOV A,R0
	DIV AB
	MOV R6, B
	MOV A, R0
	
	CJNE A, #31, OCAK
	SJMP EXITOCAK
	OCAK:JC EXITOCAK
	CJNE A, #60 ,SUBAT
	SJMP EXITSUBAT
	SUBAT: JC EXITSUBAT
	CJNE A, #91, MART
	SJMP EXITMART
	MART: JC EXITMART
	CJNE A, #121, NISAN
	SJMP EXITNISAN
	NISAN: JC EXITNISAN
	CJNE A, #152, MAYIS
	SJMP EXITMAYIS
	MAYIS: JC EXITMAYIS
	CJNE A, #182, HAZIRAN
	SJMP EXITHAZIRAN
	HAZIRAN: JC EXITHAZIRAN
	CJNE A, #213, TEMMUZ
	SJMP EXITTEMMUZ
	TEMMUZ: JC EXITTEMMUZ
	CJNE A, #244, AGUSTOS
	LJMP EXITAGUSTOS
	AGUSTOS: JC EXITAGUSTOS
	LJMP EXITEYLUL1
	KONTROL1:

	
	BURA: MOV B, #7
	mov A, r0
	ADD A, #04D
	DIV AB 
	MOV R6,B 

	
	MOV A,R0

	CJNE A, #18, EYLUL
	
	LJMP EXITEYLUL
	EYLUL: JC EXITEYLUL
	CJNE A, #49, EKIM
	LJMP EXITEKIM
	EKIM: JC EXITEKIM
	CJNE A, #79, KASIM
	LJMP  EXITKASIM
	KASIM: JC EXITKASIM
	LJMP EXITARALIK
	
	
	

	EXITOCAK: MOV R3, #1D
	MOV R4, A
	LJMP LASTSENTENCE
	
	
	EXITSUBAT: MOV R3, #2D
	MOV R5, #31
	
	OCAKCIKART:DEC A
	DJNZ R5,OCAKCIKART
	MOV R4, A 
	LJMP LASTSENTENCE
	
	EXITMART: MOV R3, #3D
	MOV R5, #60
	
	
	
	SUBATCIKART:DEC A
	DJNZ R5,SUBATCIKART
	MOV R4, A 
	LJMP LASTSENTENCE
	
	EXITNISAN: MOV R3, #4D
	MOV R5, #91

	
	
	MARTCIKART:DEC A
	DJNZ R5,MARTCIKART
	MOV R4, A 
	LJMP LASTSENTENCE
	
	EXITMAYIS: MOV R3, #5D
	MOV R5, #121

	
	
	NISANCIKART:DEC A
	DJNZ R5,NISANCIKART
	MOV R4, A  
	LJMP LASTSENTENCE
	
	EXITHAZIRAN: MOV R3, #6D
	MOV R5, #152
	
	
	MAYISCIKART:DEC A
	DJNZ R5,MAYISCIKART
	MOV R4, A  
	LJMP LASTSENTENCE
	
	EXITTEMMUZ: MOV R3, #7D
	MOV R5, #182

	
	
	HAZIRANCIKART:DEC A
	DJNZ R5,HAZIRANCIKART
	MOV R4, A   
	LJMP LASTSENTENCE
	
	EXITAGUSTOS: MOV R3, #8D
	MOV R5, #213
	TEMMUZCIKART:DEC A
	DJNZ R5,TEMMUZCIKART
	MOV R4, A   
	LJMP LASTSENTENCE
	
	EXITEYLUL1: MOV R3, #9D
	MOV R5, #244
	AGUSTOSCIKART:DEC A
	DJNZ R5,AGUSTOSCIKART
	MOV R4, A  
	LJMP LASTSENTENCE
	
	EXITEYLUL: MOV R3, #9D
	MOV R5, #12
	EKLE:INC A
	DJNZ R5,EKLE
	MOV R4, A 
	LJMP LASTSENTENCE
	
	EXITEKIM: MOV R3, #10D
	MOV R5, #18
	ONSEKIZCIKART:DEC A
	DJNZ R5,ONSEKIZCIKART
	MOV R4, A   
	LJMP LASTSENTENCE
	
	EXITKASIM: MOV R3, #11D
	MOV R5, #49
	KIRKDOKUZCIKART:DEC A
	DJNZ R5,KIRKDOKUZCIKART
	MOV R4, A
	LJMP LASTSENTENCE
	
	EXITARALIK: MOV R3, #12D
	MOV R5, #79
	YETMISDOKUZCIKART:DEC A
	DJNZ R5,YETMISDOKUZCIKART
	MOV R4, A
	LASTSENTENCE: 
	

DATA_FINISHED: 
	mov A, #0C0h  
	acall send_command

	MOV A, R4
	MOV R7, A 
	MOV A, R3
	MOV R4, A
	MOV A, R7
	MOV R5, A

;
	clr A
	CJNE R4, #01H, gec1
	mov DPTR, #AY1
	SJMP FIN4
gec1:
	CJNE R4, #02H, gec4
	mov DPTR, #AY2
	SJMP FIN4
gec4:
	CJNE R4, #03H, gec5
	mov DPTR, #AY3
	SJMP FIN4
gec5:
	CJNE R4, #04H, gec6
	mov DPTR, #AY4
	SJMP FIN4
gec6:
	CJNE R4, #05H, gec7
	mov DPTR, #AY5
	SJMP FIN4
gec7:
	CJNE R4, #06H, gec8
	mov DPTR, #AY6
	SJMP FIN4
gec8:
	CJNE R4, #07H, gec9
	mov DPTR, #AY7
	SJMP FIN4
gec9:
	CJNE R4, #08H, gec10
	mov DPTR, #AY8
	SJMP FIN4
gec10:
	CJNE R4, #09H, gec11
	mov DPTR, #AY9
	SJMP FIN4
gec11:
	CJNE R4, #0AH, gec12
	mov DPTR, #AY10
	SJMP FIN4
gec12:
	CJNE R4, #0BH, gec13
	mov DPTR, #AY11
	SJMP FIN4
gec13:
	mov DPTR, #AY12

FIN4:

PRINT_LOOP:

	movc a,@a+dptr
	jz FIN3
	acall SEND_DATA
	CLR A
	inc dptr
	sjmp PRINT_LOOP

FIN3: 
	CJNE R5, #10D, gec14
gec14: JNC gec15
	MOV A, R5
	ADD A, #30H
	acall SEND_DATA
	SJMP FIN5
	
gec15:	MOV A, R5
	MOV B, #10D
	DIV AB
	ADD A, #30H
	acall SEND_DATA
	MOV A, B
	ADD A, #30H
	acall SEND_DATA
	
FIN5: 
	clr A
	CJNE R6, #0D, uza1
	mov DPTR, #GUN1
	SJMP FIN6
uza1:
	CJNE R6, #1D, uza2
	mov DPTR, #GUN2
	SJMP FIN6
uza2:
	CJNE R6, #2D, uza3
	mov DPTR, #GUN3
	SJMP FIN6
uza3:
	CJNE R6, #3D, uza4
	mov DPTR, #GUN4
	SJMP FIN6
uza4:
	CJNE R6, #4D, uza5
	mov DPTR, #GUN5
	SJMP FIN6
uza5:
	CJNE R6, #5D, uza6
	mov DPTR, #GUN6
	SJMP FIN6
uza6:
	mov DPTR, #GUN7

FIN6:

PRINT_LOOP2:

	movc a,@a+dptr
	jz FIN6
	acall SEND_DATA
	CLR A
	inc dptr
	sjmp PRINT_LOOP2

FIN7: SJMP FIN7

CONFIGURE_LCD:	
	mov a,#38H	
	acall SEND_COMMAND
	mov a,#0FH	
	acall SEND_COMMAND
	mov a,#06H	
	acall SEND_COMMAND
	mov a,#01H	
	acall SEND_COMMAND
	mov a,#80H	
	acall SEND_COMMAND
	ret

SEND_COMMAND: 
	mov p1,a		
	clr p3.5		
	clr p3.6	
	setb p3.7	
	acall DELAY
	clr p3.7
	ret

SEND_DATA: 
	mov p1,a		
	setb p3.5	
	clr p3.6		
	setb p3.7	
	acall DELAY
	clr p3.7
	ret

DELAY:
	push 0
	push 1
	mov r0,#50

DELAY_OUTER_LOOP:
	mov r1,#255
	djnz r1,$
	djnz r0,DELAY_OUTER_LOOP
	pop 1
	pop 0
	ret

KEYBOARD: 
	mov	P0, #0ffh	
K1:
	mov	P2, #0	
	mov	A, P0
	anl	A, #00001111B
	cjne	A, #00001111B, K1
K2:
	acall	DELAY
	mov	A, P0
	anl	A, #00001111B
	cjne	A, #00001111B, KB_OVER
	sjmp	K2
KB_OVER:
	acall DELAY
	mov	A, P0
	anl	A, #00001111B
	cjne	A, #00001111B, KB_OVER1
	sjmp	K2
KB_OVER1:
	mov	P2, #11111110B
	mov	A, P0
	anl	A, #00001111B
	cjne	A, #00001111B, ROW_0
	mov	P2, #11111101B
	mov	A, P0
	anl	A, #00001111B
	cjne	A, #00001111B, ROW_1
	mov	P2, #11111011B
	mov	A, P0
	anl	A, #00001111B
	cjne	A, #00001111B, ROW_2
	mov	P2, #11110111B
	mov	A, P0
	anl	A, #00001111B
	cjne	A, #00001111B, ROW_3
	ljmp	K2
	
ROW_0:
	mov	DPTR, #KCODE0
	sjmp	KB_FIND
ROW_1:
	mov	DPTR, #KCODE1
	sjmp	KB_FIND
ROW_2:
	mov	DPTR, #KCODE2
	sjmp	KB_FIND
ROW_3:
	mov	DPTR, #KCODE3
KB_FIND:
	rrc	A
	jnc	KB_MATCH
	inc	DPTR
	sjmp	KB_FIND
KB_MATCH:
	clr	A
	movc	A, @A+DPTR
	ret

KCODE0:	DB	'1', '2', '3', 'A'
KCODE1:	DB	'4', '5', '6', 'B'
KCODE2:	DB	'7', '8', '9', 'C'
KCODE3:	DB	'*', '0', '#', 'D'

INPUT: DB 'INPUT=',0

AY1: DB 'JAN ',0
AY2: DB 'FEB ',0
AY3: DB 'MAR ',0
AY4: DB 'APR ',0
AY5: DB 'MAY ',0
AY6: DB 'JUN ',0
AY7: DB 'JUL ',0
AY8: DB 'AGU ',0
AY9: DB 'SEP ',0
AY10: DB 'OCT ',0
AY11: DB 'NOV ',0
AY12: DB 'DEC ',0

GUN1: DB ' SUN',0
GUN2: DB ' MON',0
GUN3: DB ' TUE',0
GUN4: DB ' WED',0
GUN5: DB ' THU',0
GUN6: DB ' FRI',0
GUN7: DBÂ ' SAT',0

END

	
	
	




